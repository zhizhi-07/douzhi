# AI自主修改网名和个性签名功能说明 ✏️

## 功能概述

AI现在可以自主修改自己的网名和个性签名，让AI角色更加真实和富有个性！

## 使用方式

### 1. 修改网名
```
[网名:新的网名]
```

**示例：**
```
AI: 我觉得"小可爱"这个名字更适合我~
    [网名:小可爱]
```

**效果：**
- 系统提示：汁汁更改了网名
- 聊天列表、通讯录、角色详情页实时同步新网名

### 2. 修改个性签名
```
[个性签名:新的签名]
```

**示例：**
```
AI: [个性签名:今天心情不错~]
```

**效果：**
- 系统提示：汁汁更改了个性签名
- 角色详情页的签名实时更新

## 使用场景

### 场景1：心情变化
```
用户: 你今天怎么这么开心？
AI: 嘿嘿，当然开心啦！
    [个性签名:今天超级开心ヽ(°▽°)ノ]
```

### 场景2：关系升级
```
用户: 我们在一起吧
AI: 好呀！我超开心的！
    [网名:你的小宝贝]
    [个性签名:有你真好♡]
```

### 场景3：个性展示
```
AI: 感觉"小汁"这个名字更可爱一点
    [网名:小汁]
    
用户: 哈哈哈确实
AI: 嘿嘿~ [个性签名:可爱又迷人的反派角色]
```

### 场景4：情绪表达
```
用户: [做了让AI不开心的事]
AI: 哼！
    [个性签名:生气了不想说话]
```

## 技术实现

### 1. 系统提示词
在 `chatApi.ts` 中添加了功能说明：
```typescript
想修改自己的网名或个性签名？
[网名:新的网名] - 修改你的网名，比如[网名:小可爱]
[个性签名:新的签名] - 修改你的个性签名，比如[个性签名:今天心情不错~]
⚠️ 这是修改你自己的信息！不要频繁改，只在真的想换的时候用
```

### 2. 指令处理器
在 `commandHandlers.ts` 中实现了两个处理器：

**changeNicknameHandler（修改网名）：**
- 正则：`/\[网名:(.+?)\]/`
- 更新 character.nickname
- 显示系统消息："XX更改了网名"
- AI记忆中包含完整信息

**changeSignatureHandler（修改签名）：**
- 正则：`/\[个性签名:(.+?)\]/`
- 更新 character.signature
- 显示系统消息："XX更改了个性签名"
- AI记忆中包含完整信息

### 3. 数据同步
使用 `characterService.update()` 更新角色信息：
```typescript
characterService.update(character.id, { 
  nickname: newNickname 
})
```

所有使用该角色的地方自动同步：
- ✅ 聊天列表
- ✅ 通讯录
- ✅ 角色详情页
- ✅ 聊天界面
- ✅ 朋友圈显示

### 4. AI可读内容
系统消息包含AI可读的完整信息：
```typescript
aiReadableContent: `[系统通知：你将自己的网名从"${oldNickname}"改成了"${newNickname}"，用户会看到灰色小字提示]`
```

AI能在后续对话中记住这个修改！

## 用户体验

### 用户视角
1. AI说："我想改个名字~"
2. 发送：`[网名:小可爱]`
3. 看到灰色系统提示："汁汁更改了网名"
4. 聊天列表、通讯录等所有地方的名字都变了

### AI视角
1. AI决定："我要改个更可爱的名字"
2. 发送：`我觉得叫小可爱更好~ [网名:小可爱]`
3. 系统反馈：成功修改，显示系统提示
4. AI能在后续对话中记住："我之前把网名改成了小可爱"

## 注意事项

1. **不要频繁修改**
   - AI应该在有明确理由时才修改
   - 比如：关系变化、心情变化、特殊场合

2. **网名和签名的区别**
   - 网名：显示在聊天列表、通讯录等地方
   - 签名：只在角色详情页显示

3. **修改会被记忆**
   - 系统消息包含 `aiReadableContent`
   - AI能记住修改历史
   - 可以在对话中提到之前的修改

4. **实时同步**
   - 修改立即生效
   - 无需刷新页面
   - 所有地方自动更新

## 实现文件

- ✅ `src/utils/chatApi.ts` - 系统提示词
- ✅ `src/pages/ChatDetail/hooks/commandHandlers.ts` - 指令处理
- ✅ `src/services/characterService.ts` - 角色数据更新

## 效果示例

**完整对话流程：**
```
用户: 你这个网名不太好听
AI: 是吗？那我换一个！
    [网名:软萌小汁]
系统: 汁汁更改了网名

用户: 这个好多了哈哈
AI: 嘿嘿~再换个签名吧
    [个性签名:做你的小可爱٩(๑❛ᴗ❛๑)۶]
系统: 软萌小汁更改了个性签名

用户: 太可爱了吧！
AI: 嘻嘻，喜欢就好~
```

## 总结

AI现在拥有完整的自我管理能力：
- ✅ 修改网名（展示个性）
- ✅ 修改个性签名（表达心情）
- ✅ 实时同步（立即生效）
- ✅ 记忆保持（AI记住修改）

让AI角色更加真实、生动、富有个性！✨
