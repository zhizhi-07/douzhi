<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ°”æ³¡ç¼–è¾‘å™¨ - ç‹¬ç«‹ç‰ˆ</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: #F5F5F0;
      min-height: 100vh;
    }
    
    .header {
      background: white;
      border-bottom: 1px solid #e5e5e5;
      padding: 16px 24px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    
    .header h1 {
      font-size: 20px;
      font-weight: 700;
      color: #1A1A1A;
    }
    
    .header-actions {
      display: flex;
      gap: 12px;
    }
    
    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 50px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .btn-primary {
      background: #FF6B35;
      color: white;
    }
    
    .btn-primary:hover {
      background: #FF5520;
      transform: translateY(-1px);
    }
    
    .btn-secondary {
      background: #1A1A1A;
      color: white;
    }
    
    .btn-secondary:hover {
      background: #2A2A2A;
    }
    
    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 24px;
      display: grid;
      grid-template-columns: 350px 1fr 400px;
      gap: 24px;
    }
    
    .card {
      background: white;
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.08);
    }
    
    .card h2 {
      font-size: 16px;
      font-weight: 700;
      margin-bottom: 16px;
      color: #1A1A1A;
    }
    
    textarea {
      width: 100%;
      padding: 12px;
      border: 2px solid #f0f0f0;
      border-radius: 12px;
      resize: vertical;
      font-size: 14px;
      font-family: inherit;
      transition: all 0.3s;
    }
    
    textarea:focus {
      outline: none;
      border-color: #FF6B35;
    }
    
    .control-group {
      margin-bottom: 20px;
    }
    
    .control-label {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      font-size: 14px;
      color: #666;
    }
    
    .control-value {
      font-weight: 600;
      color: #1A1A1A;
    }
    
    input[type="color"] {
      width: 50px;
      height: 50px;
      border: 2px solid #e5e5e5;
      border-radius: 12px;
      cursor: pointer;
    }
    
    input[type="range"] {
      width: 100%;
      height: 6px;
      background: #e5e5e5;
      border-radius: 3px;
      outline: none;
    }
    
    input[type="range"]::-webkit-slider-thumb {
      width: 18px;
      height: 18px;
      background: #FF6B35;
      border-radius: 50%;
      cursor: pointer;
    }
    
    .switch {
      width: 50px;
      height: 26px;
      background: #ccc;
      border-radius: 13px;
      position: relative;
      cursor: pointer;
      transition: background 0.3s;
    }
    
    .switch.active {
      background: #FF6B35;
    }
    
    .switch-thumb {
      width: 22px;
      height: 22px;
      background: white;
      border-radius: 50%;
      position: absolute;
      top: 2px;
      left: 2px;
      transition: transform 0.3s;
    }
    
    .switch.active .switch-thumb {
      transform: translateX(24px);
    }
    
    .tabs {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 20px;
    }
    
    .tab {
      padding: 12px;
      border: none;
      border-radius: 12px;
      background: #f0f0f0;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .tab.active {
      background: #FF6B35;
      color: white;
    }
    
    .preview-area {
      background: #f8f8f8;
      border-radius: 12px;
      padding: 24px;
      min-height: 500px;
    }
    
    .preview-messages {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    
    .message-row {
      display: flex;
    }
    
    .message-row.user {
      justify-content: flex-end;
    }
    
    .message-bubble {
      max-width: 70%;
      display: inline-block;
    }
    
    .controls-column {
      max-height: 800px;
      overflow-y: auto;
    }
    
    .controls-column::-webkit-scrollbar {
      width: 6px;
    }
    
    .controls-column::-webkit-scrollbar-thumb {
      background: #ccc;
      border-radius: 3px;
    }
    
    pre {
      background: #1A1A1A;
      color: #F5F5F0;
      padding: 16px;
      border-radius: 12px;
      font-size: 12px;
      overflow-x: auto;
      max-height: 400px;
      overflow-y: auto;
    }
    
    @media (max-width: 1200px) {
      .container {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- é¡¶éƒ¨å¯¼èˆª -->
  <div class="header">
    <h1>ğŸ¨ æ°”æ³¡ç¼–è¾‘å™¨</h1>
    <div class="header-actions">
      <button class="btn btn-secondary" onclick="copyCSS()">å¤åˆ¶CSS</button>
      <button class="btn btn-primary" onclick="saveStyle()">ä¿å­˜æ ·å¼</button>
    </div>
  </div>

  <div class="container">
    <!-- å·¦ä¾§ï¼šè¾“å…¥åŒº -->
    <div>
      <!-- ç²˜è´´CSS -->
      <div class="card">
        <h2>ğŸ“‹ ç²˜è´´CSSä»£ç </h2>
        <textarea id="cssInput" rows="8" placeholder=".message-container.sent .message-bubble {&#10;  background: #FF6B9D;&#10;  color: white;&#10;  border-radius: 20px;&#10;  ...&#10;}"></textarea>
        <button class="btn btn-secondary" onclick="parseCSS()" style="width: 100%; margin-top: 12px;">è§£æCSS</button>
      </div>

      <!-- åˆ‡æ¢æ ‡ç­¾ -->
      <div class="card" style="margin-top: 20px;">
        <div class="tabs">
          <button class="tab active" onclick="switchTab('user')">ç”¨æˆ·æ°”æ³¡</button>
          <button class="tab" onclick="switchTab('ai')">AIæ°”æ³¡</button>
        </div>
      </div>
    </div>

    <!-- ä¸­é—´ï¼šå¯è§†åŒ–æ§åˆ¶å™¨ -->
    <div class="controls-column">
      <!-- èƒŒæ™¯ -->
      <div class="card">
        <h2>ğŸ¨ èƒŒæ™¯</h2>
        
        <div class="control-group">
          <div class="control-label">
            <span>å¯ç”¨æ¸å˜</span>
            <div class="switch" id="gradientSwitch" onclick="toggleGradient()">
              <div class="switch-thumb"></div>
            </div>
          </div>
        </div>

        <div id="solidBgControls">
          <div class="control-group">
            <div class="control-label">
              <span>èƒŒæ™¯é¢œè‰²</span>
              <input type="color" id="bgColor" value="#1F2937" onchange="updatePreview()">
            </div>
          </div>

          <div class="control-group">
            <div class="control-label">
              <span>èƒŒæ™¯é€æ˜åº¦</span>
              <span class="control-value" id="bgOpacityValue">100%</span>
            </div>
            <input type="range" id="bgOpacity" min="0" max="100" value="100" oninput="updateOpacityValue('bgOpacity')">
          </div>
        </div>

        <div id="gradientControls" style="display: none;">
          <div class="control-group">
            <div class="control-label">
              <span>æ¸å˜èµ·å§‹è‰²</span>
              <input type="color" id="gradientColor1" value="#667eea" onchange="updatePreview()">
            </div>
          </div>

          <div class="control-group">
            <div class="control-label">
              <span>æ¸å˜ç»“æŸè‰²</span>
              <input type="color" id="gradientColor2" value="#764ba2" onchange="updatePreview()">
            </div>
          </div>

          <div class="control-group">
            <div class="control-label">
              <span>æ¸å˜è§’åº¦</span>
              <span class="control-value" id="gradientAngleValue">135Â°</span>
            </div>
            <input type="range" id="gradientAngle" min="0" max="360" value="135" oninput="updateAngleValue()">
          </div>
        </div>
      </div>

      <!-- æ–‡å­— -->
      <div class="card" style="margin-top: 20px;">
        <h2>ğŸ“ æ–‡å­—</h2>
        
        <div class="control-group">
          <div class="control-label">
            <span>æ–‡å­—é¢œè‰²</span>
            <input type="color" id="textColor" value="#FFFFFF" onchange="updatePreview()">
          </div>
        </div>

        <div class="control-group">
          <div class="control-label">
            <span>æ–‡å­—é€æ˜åº¦</span>
            <span class="control-value" id="textOpacityValue">100%</span>
          </div>
          <input type="range" id="textOpacity" min="0" max="100" value="100" oninput="updateOpacityValue('textOpacity')">
        </div>
      </div>

      <!-- è¾¹æ¡† -->
      <div class="card" style="margin-top: 20px;">
        <h2>ğŸ”² è¾¹æ¡†</h2>
        
        <div class="control-group">
          <div class="control-label">
            <span>åœ†è§’å¤§å°</span>
            <span class="control-value" id="borderRadiusValue">18px</span>
          </div>
          <input type="range" id="borderRadius" min="0" max="50" value="18" oninput="updatePixelValue('borderRadius')">
        </div>

        <div class="control-group">
          <div class="control-label">
            <span>è¾¹æ¡†å®½åº¦</span>
            <span class="control-value" id="borderWidthValue">0px</span>
          </div>
          <input type="range" id="borderWidth" min="0" max="5" value="0" oninput="updatePixelValue('borderWidth')">
        </div>

        <div id="borderColorControl" style="display: none;">
          <div class="control-group">
            <div class="control-label">
              <span>è¾¹æ¡†é¢œè‰²</span>
              <input type="color" id="borderColor" value="#000000" onchange="updatePreview()">
            </div>
          </div>
        </div>
      </div>

      <!-- é˜´å½± -->
      <div class="card" style="margin-top: 20px;">
        <h2>ğŸŒ‘ é˜´å½±</h2>
        
        <div class="control-group">
          <div class="control-label">
            <span>æ¨¡ç³ŠåŠå¾„</span>
            <span class="control-value" id="shadowBlurValue">8px</span>
          </div>
          <input type="range" id="shadowBlur" min="0" max="50" value="8" oninput="updatePixelValue('shadowBlur')">
        </div>

        <div class="control-group">
          <div class="control-label">
            <span>é˜´å½±é€æ˜åº¦</span>
            <span class="control-value" id="shadowOpacityValue">8%</span>
          </div>
          <input type="range" id="shadowOpacity" min="0" max="100" value="8" oninput="updatePercentValue('shadowOpacity')">
        </div>
      </div>
    </div>

    <!-- å³ä¾§ï¼šé¢„è§ˆåŒº -->
    <div>
      <div class="card">
        <h2>ğŸ‘ï¸ å®æ—¶é¢„è§ˆ</h2>
        <div class="preview-area">
          <div class="preview-messages">
            <div class="message-row user">
              <div class="message-bubble" id="userBubble1">ä½ å¥½ï¼è¿™æ˜¯ç”¨æˆ·æ¶ˆæ¯</div>
            </div>
            <div class="message-row">
              <div class="message-bubble" id="aiBubble1">ä½ å¥½ï¼è¿™æ˜¯AIå›å¤</div>
            </div>
            <div class="message-row user">
              <div class="message-bubble" id="userBubble2">è¿™ä¸ªæ°”æ³¡æ ·å¼æ€ä¹ˆæ ·ï¼Ÿ</div>
            </div>
            <div class="message-row">
              <div class="message-bubble" id="aiBubble2">çœ‹èµ·æ¥å¾ˆä¸é”™ï¼âœ¨</div>
            </div>
          </div>
        </div>
      </div>

      <div class="card" style="margin-top: 20px;">
        <h2>ğŸ“ ç”Ÿæˆçš„CSS</h2>
        <pre id="cssOutput"></pre>
      </div>
    </div>
  </div>

  <script>
    // å½“å‰ç¼–è¾‘çš„æ°”æ³¡ç±»å‹
    let currentTab = 'user';
    
    // ç”¨æˆ·æ°”æ³¡æ ·å¼
    let userStyle = {
      useGradient: false,
      bgColor: '#1F2937',
      bgOpacity: 100,
      gradientColor1: '#667eea',
      gradientColor2: '#764ba2',
      gradientAngle: 135,
      textColor: '#FFFFFF',
      textOpacity: 100,
      borderRadius: 18,
      borderWidth: 0,
      borderColor: '#000000',
      shadowBlur: 8,
      shadowOpacity: 8
    };
    
    // AIæ°”æ³¡æ ·å¼
    let aiStyle = {
      useGradient: false,
      bgColor: '#FFFFFF',
      bgOpacity: 100,
      gradientColor1: '#667eea',
      gradientColor2: '#764ba2',
      gradientAngle: 135,
      textColor: '#1F2937',
      textOpacity: 100,
      borderRadius: 18,
      borderWidth: 1,
      borderColor: '#000000',
      shadowBlur: 8,
      shadowOpacity: 8
    };
    
    // åˆ‡æ¢æ ‡ç­¾
    function switchTab(tab) {
      currentTab = tab;
      
      // æ›´æ–°æ ‡ç­¾æ ·å¼
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      event.target.classList.add('active');
      
      // åŠ è½½å¯¹åº”æ ·å¼åˆ°æ§åˆ¶å™¨
      loadStyleToControls();
    }
    
    // åŠ è½½æ ·å¼åˆ°æ§åˆ¶å™¨
    function loadStyleToControls() {
      const style = currentTab === 'user' ? userStyle : aiStyle;
      
      document.getElementById('gradientSwitch').classList.toggle('active', style.useGradient);
      document.getElementById('solidBgControls').style.display = style.useGradient ? 'none' : 'block';
      document.getElementById('gradientControls').style.display = style.useGradient ? 'block' : 'none';
      
      document.getElementById('bgColor').value = style.bgColor;
      document.getElementById('bgOpacity').value = style.bgOpacity;
      document.getElementById('gradientColor1').value = style.gradientColor1;
      document.getElementById('gradientColor2').value = style.gradientColor2;
      document.getElementById('gradientAngle').value = style.gradientAngle;
      document.getElementById('textColor').value = style.textColor;
      document.getElementById('textOpacity').value = style.textOpacity;
      document.getElementById('borderRadius').value = style.borderRadius;
      document.getElementById('borderWidth').value = style.borderWidth;
      document.getElementById('borderColor').value = style.borderColor;
      document.getElementById('shadowBlur').value = style.shadowBlur;
      document.getElementById('shadowOpacity').value = style.shadowOpacity;
      
      updateAllValues();
      updatePreview();
    }
    
    // åˆ‡æ¢æ¸å˜
    function toggleGradient() {
      const style = currentTab === 'user' ? userStyle : aiStyle;
      style.useGradient = !style.useGradient;
      loadStyleToControls();
    }
    
    // æ›´æ–°æ‰€æœ‰æ˜¾ç¤ºå€¼
    function updateAllValues() {
      updateOpacityValue('bgOpacity');
      updateOpacityValue('textOpacity');
      updateAngleValue();
      updatePixelValue('borderRadius');
      updatePixelValue('borderWidth');
      updatePixelValue('shadowBlur');
      updatePercentValue('shadowOpacity');
    }
    
    // æ›´æ–°é€æ˜åº¦å€¼æ˜¾ç¤º
    function updateOpacityValue(id) {
      const value = document.getElementById(id).value;
      document.getElementById(id + 'Value').textContent = value + '%';
      
      const style = currentTab === 'user' ? userStyle : aiStyle;
      const key = id.replace('Value', '');
      style[key] = parseInt(value);
      
      updatePreview();
    }
    
    // æ›´æ–°åƒç´ å€¼æ˜¾ç¤º
    function updatePixelValue(id) {
      const value = document.getElementById(id).value;
      document.getElementById(id + 'Value').textContent = value + 'px';
      
      const style = currentTab === 'user' ? userStyle : aiStyle;
      const key = id.replace('Value', '');
      style[key] = parseInt(value);
      
      if (id === 'borderWidth') {
        document.getElementById('borderColorControl').style.display = value > 0 ? 'block' : 'none';
      }
      
      updatePreview();
    }
    
    // æ›´æ–°ç™¾åˆ†æ¯”å€¼æ˜¾ç¤º
    function updatePercentValue(id) {
      const value = document.getElementById(id).value;
      document.getElementById(id + 'Value').textContent = value + '%';
      
      const style = currentTab === 'user' ? userStyle : aiStyle;
      const key = id.replace('Value', '');
      style[key] = parseInt(value);
      
      updatePreview();
    }
    
    // æ›´æ–°è§’åº¦å€¼æ˜¾ç¤º
    function updateAngleValue() {
      const value = document.getElementById('gradientAngle').value;
      document.getElementById('gradientAngleValue').textContent = value + 'Â°';
      
      const style = currentTab === 'user' ? userStyle : aiStyle;
      style.gradientAngle = parseInt(value);
      
      updatePreview();
    }
    
    // ç”ŸæˆCSS
    function generateCSS(style, isUser) {
      let background = '';
      if (style.useGradient) {
        background = `linear-gradient(${style.gradientAngle}deg, ${style.gradientColor1}, ${style.gradientColor2})`;
      } else {
        const opacity = (style.bgOpacity / 100).toFixed(2);
        const r = parseInt(style.bgColor.slice(1, 3), 16);
        const g = parseInt(style.bgColor.slice(3, 5), 16);
        const b = parseInt(style.bgColor.slice(5, 7), 16);
        background = `rgba(${r}, ${g}, ${b}, ${opacity})`;
      }
      
      const textOpacity = (style.textOpacity / 100).toFixed(2);
      const tr = parseInt(style.textColor.slice(1, 3), 16);
      const tg = parseInt(style.textColor.slice(3, 5), 16);
      const tb = parseInt(style.textColor.slice(5, 7), 16);
      const textColor = `rgba(${tr}, ${tg}, ${tb}, ${textOpacity})`;
      
      const shadowOpacity = (style.shadowOpacity / 100).toFixed(2);
      const boxShadow = `0 2px ${style.shadowBlur}px rgba(0, 0, 0, ${shadowOpacity})`;
      
      return `${isUser ? '.user-bubble' : '.ai-bubble'} {
  background: ${background};
  color: ${textColor};
  border-radius: ${style.borderRadius}px;
  padding: 10px 14px;
  box-shadow: ${boxShadow};${style.borderWidth > 0 ? `\n  border: ${style.borderWidth}px solid ${style.borderColor};` : ''}
}`;
    }
    
    // æ›´æ–°é¢„è§ˆ
    function updatePreview() {
      // æ›´æ–°ç”¨æˆ·æ°”æ³¡
      const userCSS = generateCSSProperties(userStyle);
      document.getElementById('userBubble1').setAttribute('style', userCSS);
      document.getElementById('userBubble2').setAttribute('style', userCSS);
      
      // æ›´æ–°AIæ°”æ³¡
      const aiCSS = generateCSSProperties(aiStyle);
      document.getElementById('aiBubble1').setAttribute('style', aiCSS);
      document.getElementById('aiBubble2').setAttribute('style', aiCSS);
      
      // æ›´æ–°CSSä»£ç æ˜¾ç¤º
      const fullCSS = generateCSS(userStyle, true) + '\n\n' + generateCSS(aiStyle, false);
      document.getElementById('cssOutput').textContent = fullCSS;
    }
    
    // ç”ŸæˆCSSå±æ€§
    function generateCSSProperties(style) {
      let background = '';
      if (style.useGradient) {
        background = `linear-gradient(${style.gradientAngle}deg, ${style.gradientColor1}, ${style.gradientColor2})`;
      } else {
        const opacity = (style.bgOpacity / 100).toFixed(2);
        const r = parseInt(style.bgColor.slice(1, 3), 16);
        const g = parseInt(style.bgColor.slice(3, 5), 16);
        const b = parseInt(style.bgColor.slice(5, 7), 16);
        background = `rgba(${r}, ${g}, ${b}, ${opacity})`;
      }
      
      const textOpacity = (style.textOpacity / 100).toFixed(2);
      const tr = parseInt(style.textColor.slice(1, 3), 16);
      const tg = parseInt(style.textColor.slice(3, 5), 16);
      const tb = parseInt(style.textColor.slice(5, 7), 16);
      const textColor = `rgba(${tr}, ${tg}, ${tb}, ${textOpacity})`;
      
      const shadowOpacity = (style.shadowOpacity / 100).toFixed(2);
      const boxShadow = `0 2px ${style.shadowBlur}px rgba(0, 0, 0, ${shadowOpacity})`;
      
      let css = `background: ${background}; color: ${textColor}; border-radius: ${style.borderRadius}px; padding: 10px 14px; box-shadow: ${boxShadow};`;
      if (style.borderWidth > 0) {
        css += ` border: ${style.borderWidth}px solid ${style.borderColor};`;
      }
      
      return css;
    }
    
    // è§£æCSS
    function parseCSS() {
      const cssText = document.getElementById('cssInput').value;
      if (!cssText.trim()) {
        alert('è¯·å…ˆç²˜è´´CSSä»£ç ');
        return;
      }
      
      const style = currentTab === 'user' ? userStyle : aiStyle;
      
      // è§£æèƒŒæ™¯
      const bgMatch = cssText.match(/background:\s*([^;]+)/i);
      if (bgMatch) {
        const bg = bgMatch[1].trim();
        if (bg.includes('gradient')) {
          style.useGradient = true;
          const colors = bg.match(/#[0-9a-f]{6}/gi);
          if (colors && colors.length >= 2) {
            style.gradientColor1 = colors[0];
            style.gradientColor2 = colors[1];
          }
          const angleMatch = bg.match(/(\d+)deg/);
          if (angleMatch) {
            style.gradientAngle = parseInt(angleMatch[1]);
          }
        } else {
          style.useGradient = false;
          const colorMatch = bg.match(/#[0-9a-f]{6}/i);
          if (colorMatch) {
            style.bgColor = colorMatch[0];
          }
        }
      }
      
      // è§£æé¢œè‰²
      const colorMatch = cssText.match(/color:\s*([^;]+)/i);
      if (colorMatch) {
        const color = colorMatch[1].trim();
        const hexMatch = color.match(/#[0-9a-f]{6}/i);
        if (hexMatch) {
          style.textColor = hexMatch[0];
        }
      }
      
      // è§£æåœ†è§’
      const radiusMatch = cssText.match(/border-radius:\s*(\d+)px/i);
      if (radiusMatch) {
        style.borderRadius = parseInt(radiusMatch[1]);
      }
      
      // è§£æè¾¹æ¡†
      const borderMatch = cssText.match(/border:\s*(\d+)px/i);
      if (borderMatch) {
        style.borderWidth = parseInt(borderMatch[1]);
      }
      
      loadStyleToControls();
      alert('âœ… CSSè§£ææˆåŠŸï¼');
    }
    
    // å¤åˆ¶CSS
    function copyCSS() {
      const cssText = document.getElementById('cssOutput').textContent;
      navigator.clipboard.writeText(cssText).then(() => {
        alert('âœ… CSSå·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
      });
    }
    
    // ä¿å­˜æ ·å¼
    function saveStyle() {
      const userCSS = generateCSS(userStyle, true);
      const aiCSS = generateCSS(aiStyle, false);
      
      localStorage.setItem('user_bubble_css', userCSS);
      localStorage.setItem('ai_bubble_css', aiCSS);
      
      alert('âœ… æ ·å¼å·²ä¿å­˜åˆ°localStorageï¼\n\nä½ å¯ä»¥åœ¨é¡¹ç›®ä¸­è¯»å–è¿™äº›CSSåº”ç”¨åˆ°èŠå¤©æ°”æ³¡ã€‚');
    }
    
    // åˆå§‹åŒ–
    updatePreview();
  </script>
</body>
</html>
