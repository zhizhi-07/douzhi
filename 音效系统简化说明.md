# 音效系统简化说明

## ✅ 完成的简化

按照你的要求，已将音效系统大幅简化：

### 1. 只保留"柔和"作为内置默认音效
- ✅ 删除了所有可爱音效（小气泡、水滴泡泡等13个）
- ✅ 删除了消息发送音效
- ✅ 删除了消息通知音效
- ✅ 删除了视频通话音效
- ✅ 只保留"柔和"作为默认内置音效，不显示在列表中

### 2. 简化音效设置页面
音效设置页面现在只有：
- **开关** - 启用/关闭系统声音
- **自定义上传** - 上传自己的音频文件

### 3. 删除的文件和功能
- ❌ 删除了音效测试页面路由 `/sound-test`
- ❌ 删除了快速测试按钮
- ❌ 删除了所有音效选择列表

## 📱 现在的使用方式

### 音效设置页面
进入：**我** → **美化** → **系统声音**

**页面内容**：
1. **说明卡片** - 介绍默认使用柔和音效
2. **系统声音开关** - 开启/关闭音效
3. **自定义音效上传** - 上传自己的音频文件

### 音效逻辑
- 默认使用柔和音效（内置，不可见）
- 如果用户上传了自定义音效，优先使用自定义音效
- 否则使用默认柔和音效

## 🔧 技术实现

### 音效管理器 (`soundManager.ts`)
```typescript
// 只有一个默认音效URL
const DEFAULT_SOUND_URL = '柔和音效URL'

// 播放逻辑：优先自定义，否则默认
export const playSystemSound = () => {
  const customSound = localStorage.getItem('custom_sound')
  const url = customSound || DEFAULT_SOUND_URL
  // ... 播放音效
}
```

### 存储键值
- `system_sound_enabled`: 音效开关 (true/false)
- `custom_sound`: 自定义音效 (base64字符串或空)

## 📋 功能清单

### ✅ 保留的功能
- 系统声音开关
- 内置柔和音效（自动使用）
- 自定义音效上传
- 自定义音效试听
- 自定义音效删除
- 全局点击音效监听

### ❌ 删除的功能
- 音效选择列表（10种可爱音效）
- 音效测试页面
- 快速测试按钮
- 消息发送音效设置
- 消息通知音效设置
- 视频通话音效设置

## 🎵 自定义音效上传

### 支持格式
- MP3
- WAV
- 其他常见音频格式

### 文件大小
- 最大 5MB

### 上传流程
1. 点击"启用系统声音"开关
2. 点击"上传音效文件"
3. 选择本地音频文件
4. 自动保存并替换默认音效

### 已上传音效管理
- **试听** - 点击播放按钮试听
- **更换** - 上传新的音效文件
- **删除** - 删除自定义音效，恢复使用默认柔和音效

## 📝 使用说明

### 开启音效
1. 进入音效设置页面
2. 打开"启用系统声音"开关
3. 完成！现在点击任何按钮都会播放柔和音效

### 使用自定义音效
1. 开启系统声音
2. 准备一个音频文件（MP3/WAV等，小于5MB）
3. 点击"上传音效文件"
4. 选择你的音频文件
5. 完成！现在点击按钮会播放你的自定义音效

### 恢复默认音效
1. 在自定义音效卡片中
2. 点击"删除音效"按钮
3. 确认删除
4. 完成！恢复使用柔和内置音效

## 🎯 设计理念

**极简主义**：
- 去除繁杂的选项
- 只保留核心功能
- 用户可以自定义，也可以直接使用默认

**用户友好**：
- 默认音效柔和不打扰
- 想个性化可以上传自己的音效
- 一个开关控制所有

---

**更新时间**: 2024-11-08  
**版本**: v4.0 极简版
